{
  "openapi": "3.0.3",
  "info": {
    "title": "HNG-PORTAL-BE API",
    "version": "1.0.0",
    "description": "API endpoints for hng portal creation."
  },

  "paths": {
    "/waitlist": {
      "post": {
        "summary": "Join the waitlist",
        "description": "Creates a new waitlist entry and sends a confirmation email.",
        "tags": ["Waitlist"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["full_name", "email", "role"],
                "properties": {
                  "full_name": { "type": "string", "example": "John Doe" },
                  "email": { "type": "string", "format": "email", "example": "johndoe@example.com" },
                  "role": { "type": "string",                    "enum": ["talent", "company"],
                    "example": "talent"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Waitlist entry created successfully.",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/Waitlist" } }
            }
          },
          "422": {
            "description": "Validation error",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ValidationError" } }
            }
          }
        }
      }
    },

    "/waitlist/{id}": {
      "get": {
        "summary": "Get waitlist entry",
        "description": "Returns the details of a waitlist entry.",
        "tags": ["Waitlist"],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "responses": {
          "200": {
            "description": "Waitlist entry retrieved successfully.",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Waitlist" } } }
          },
          "404": { "description": "Waitlist entry not found" }
        }
      }
    },

    "/employer/company/{uuid}/jobs": {
      "get": {
        "summary": "List all jobs for a company",
        "tags": ["Employer - Jobs"],
        "parameters": [
          { "name": "uuid", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "responses": {
          "200": {
            "description": "List of company job listings",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": { "type": "array", "items": { "$ref": "#/components/schemas/Job" } }
                  }
                }
              }
            }
          }
        }
      },

      "post": {
        "summary": "Create a new job",
        "tags": ["Employer - Jobs"],
        "parameters": [
          { "name": "uuid", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": { "schema": { "$ref": "#/components/schemas/JobCreateRequest" } }
          }
        },
        "responses": {
          "201": { "description": "Job created", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Job" } } } },
          "422": { "description": "Validation error" }
        }
      }
    },

    "/employer/company/{uuid}/jobs/{job_id}": {
      "get": {
        "summary": "Get job details",
        "tags": ["Employer - Jobs"],
        "parameters": [
          { "name": "uuid", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "job_id", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "responses": {
          "200": { "description": "Job details", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Job" } } } },
          "404": { "description": "Job not found" }
        }
      },

      "put": {
        "summary": "Update a job posting",
        "tags": ["Employer - Jobs"],
        "parameters": [
          { "name": "uuid", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "job_id", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": { "schema": { "$ref": "#/components/schemas/JobUpdateRequest" } }
          }
        },
        "responses": {
          "200": { "description": "Job updated" },
          "404": { "description": "Job not found" }
        }
      },

      "delete": {
        "summary": "Soft delete job",
        "tags": ["Employer - Jobs"],
        "parameters": [
          { "name": "uuid", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "job_id", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "responses": {
          "200": { "description": "Job deleted" },
          "404": { "description": "Job not found" }
        }
      }
    },

    "/employer/company/{uuid}/jobs/{job_id}/restore": {
      "post": {
        "summary": "Restore a deleted job",
        "tags": ["Employer - Jobs"],
        "parameters": [
          { "name": "uuid", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "job_id", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "responses": {
          "200": { "description": "Job restored" },
          "404": { "description": "Job not found" }
        }
      }
    },

    "/employer/company/{uuid}/jobs/{job_id}/publish": {
      "put": {
        "summary": "Publish job",
        "tags": ["Employer - Jobs"],
        "parameters": [
          { "name": "uuid", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "job_id", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "responses": { "200": { "description": "Job published" }, "404": { "description": "Job not found" } }
      }
    },

    "/employer/company/{uuid}/jobs/{job_id}/unpublish": {
      "put": {
        "summary": "Unpublish job",
        "tags": ["Employer - Jobs"],
        "parameters": [
          { "name": "uuid", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "job_id", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "responses": { "200": { "description": "Job unpublished" }, "404": { "description": "Job not found" } }
      }
    }
  },

  "components": {
    "schemas": {
      "Waitlist": {
        "type": "object",
        "properties": {
          "id": { "type": "integer", "example": 12 },
          "full_name": { "type": "string", "example": "John Doe" },
          "email": { "type": "string", "example": "johndoe@example.com" },
          "role": { "type": "string", "enum": ["talent", "company"], "example": "talent" },
          "created_at": { "type": "string", "format": "date-time" },
          "updated_at": { "type": "string", "format": "date-time" }
        }
      },

      "ValidationError": {
        "type": "object",
        "properties": {
          "message": { "type": "string", "example": "The given data was invalid." },
          "errors": {
            "type": "object",
            "example": { "email": ["This email is already on our waitlist!"] }
          }
        }
      },

      "Job": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "example": "019abcde-1234-5678-9999-jobid" },
          "title": { "type": "string" },
          "description": { "type": "string" },
          "acceptance_criteria": { "type": "string", "nullable": true },
          "candidate_location_id": { "type": "string", "nullable": true },
          "company_id": { "type": "string" },
          "price": { "type": "number", "nullable": true },
          "track_id": { "type": "string", "nullable": true },
          "category_id": { "type": "string", "nullable": true },
          "job_type_id": { "type": "string", "nullable": true },
          "status": { "type": "string", "example": "draft" },
          "created_at": { "type": "string", "format": "date-time" },
          "updated_at": { "type": "string", "format": "date-time" }
        }
      },

      "JobCreateRequest": {
        "type": "object",
        "required": ["title", "description"],
        "properties": {
          "title": { "type": "string", "example": "Backend Developer" },
          "description": { "type": "string", "example": "Write and maintain API logic" },
          "acceptance_criteria": { "type": "string", "nullable": true },
          "price": { "type": "number", "nullable": true },
          "track_id": { "type": "string", "nullable": true },
          "category_id": { "type": "string", "nullable": true },
          "job_type_id": { "type": "string", "nullable": true }
        }
      },

      "JobUpdateRequest": {
        "type": "object",
        "properties": {
          "title": { "type": "string" },
          "description": { "type": "string" },
          "acceptance_criteria": { "type": "string" },
          "price": { "type": "number" },
          "track_id": { "type": "string" },
          "category_id": { "type": "string" },
          "job_type_id": { "type": "string" }
        }
      }
    }
  }
}
